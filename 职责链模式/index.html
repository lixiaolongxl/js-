<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>职责链模式</title>
</head>
<body>
    <script>
        // 定义链的某一项
        function ChainItem(fn) {
            this.fn = fn;
            this.next = null;
        }

        ChainItem.prototype = {
            constructor: ChainItem,
            
            // 设置下一项
            setNext: function(next) {
                this.next = next;
                return next;
            },
            
            // 开始执行
            start: function() {
                this.fn.apply(this, arguments);
            },
            
            // 转到链的下一项执行
            toNext: function() {
                if (this.next) {
                    this.start.apply(this.next, arguments);
                } else {
                    console.log('无匹配的执行项目');
                }
            }
        };

        // 展示数字
        function showNumber(num) {
            if (typeof num === 'number') {
                console.log('number', num);
            } else {
                // 转移到下一项
                this.toNext(num);
            }
        }

        // 展示字符串
        function showString(str) {
            if (typeof str === 'string') {
                console.log('string', str);
            } else {
                this.toNext(str);
            }
        }

        // 展示对象
        function showObject(obj) {
            if (typeof obj === 'object') {
                console.log('object', obj);
            } else {
                this.toNext(obj);
            }
        }
        // 展示未定义
        function showUndefined(obj) {
            if (typeof obj === 'undefined') {
                console.log('undefined');
            } else {
                this.toNext(obj);
            }
        }

        var chainNumber = new ChainItem(showNumber);
        var chainString = new ChainItem(showString);
        var chainObject = new ChainItem(showObject);
        var chainUndefined = new ChainItem(showUndefined);




        // 设置链条 从前到后如果没匹配到一次想下传递，直到匹配为止，下一个没有行一个的函数功能chainString 没有判断是都是数字和onject功能
        chainObject.setNext(chainNumber).setNext(chainString).setNext(chainUndefined);;

        // chainNumber.start('qqq'); // 无匹配的执行项目
        // chainString.start(12); // string 12
        // chainObject.start({}); // object {}
        // chainObject.start(); // number 123

        chainString.start({}); 
        chainString.start(123); 
        chainString.start(); 
        chainString.start('111'); 
        
        // chainUndefined.start(122); // undefined
    </script>
</body>
</html>